---
layout:     post
title:      "Linux"
subtitle:   " \"基础操作\""
date:       2020-11-20 12:00:00
author:     "Zm"
header-img: "img/post-bg-2020.jpg"
tags:
    - Linux
---

# Linux基本操作



## 关机and重启命令



| 操作命令        | 含义                     |
| --------------- | ------------------------ |
| shutdown -h now | 立即关机                 |
| shutdown -h 1   | 表示1分钟后关机          |
| shutdown -r now | 立即重启                 |
| halt            | 关机                     |
| reboot          | 重启系统                 |
| syn             | 把内存的数据同步到磁盘中 |

Ps..关机和重启前都应该先执行syn指令，将内存中的数据写入到磁盘中，防止数据丢失。

## 用户登录和注销

| 操作命令     | 含义                                     |
| ------------ | ---------------------------------------- |
| su -username | 切换用户，常用来将普通用户切换为root用户 |
| exit         | 退出当前用户，返回 su 之前的用户         |
| logout       | 注销用户（运行级别3下有效）              |

Linux是属于多用户多任务的系统，需要使用系统资源的用户都需要向系统管理员申请用户账号。

Linux用户至少属于一个组。

| 操作命令              | 可选选项                                               | 含义         |
| --------------------- | ------------------------------------------------------ | ------------ |
| useradd [选项] 用户名 | -d [...] 建立用户文件夹   -g 用户组 添加用户时同时进组 | 添加用户     |
| passwd 用户名         | /                                                      | 修改用户密码 |
| userdel [选项] 用户名 | -r 同时删除用户主目录                                  | 删除用户     |
| id 用户名             | /                                                      | 查询用户信息 |

| 操作命令       | 可选选项  | 含义   |
| -------------- | --------- | ------ |
| groupadd 组名  | /         | 增加组 |
| groupdel 组名  | /         | 删除组 |
| usermod 用户名 | -g 用户组 | 修改组 |

## 运行级别

| 运行级别 | 含义                   |
| -------- | ---------------------- |
| 0        | 关机                   |
| 1        | 单用户                 |
| 2        | 多用户状态没有网络服务 |
| 3        | 多用户状态有网络服务   |
| 4        | 系统未使用保留给用户   |
| 5        | 图形界面               |
| 6        | 系统重启               |

Ps.. 常用运行级别是3和5。

| 操作命令   | 选项 | 含义           |
| ---------- | ---- | -------------- |
| init [0-6] | /    | 切换到对应级别 |

## 帮助指令

| 操作命令             | 选项 | 含义                        |
| -------------------- | ---- | --------------------------- |
| man [命令或配置文件] | /    | 获得帮助信息                |
| help [命令]          | /    | 获得shell内置命令的帮助信息 |

## 文件目录类

| 操作命令                          | 选项                                                         | 含义                                     |
| --------------------------------- | ------------------------------------------------------------ | ---------------------------------------- |
| pwd                               | /                                                            | 显示当前目录的绝对路径                   |
| ls [选项] 目录或文件              | -l 显示隐藏文件 -ah 查看文件所有者和所在组                   | 显示当前目录下所有文件                   |
| cd [绝对路径或相对路径]           | /                                                            | 切换到对应目录下                         |
| mkdir [选项] 文件夹名             | -p 创建多级目录                                              | 创建目录                                 |
| rmdir [选项] 文件夹名             | /？                                                          | 删除文件夹（仅限空文件夹）               |
| rm -rf 文件夹名                   | /                                                            | 删除文件夹及内部所有内容                 |
| touch 文件名称                    | /                                                            | 创建文件                                 |
| cp [选项] 源文件名  指定目录      | -r 递归复制整个文件夹                                        | 拷贝文件到指定目录                       |
| mv 旧名称 新名称 or 旧路径 新路径 | /                                                            | 重命名或移动文件                         |
| cat [选项] 文件名                 | -n 显示行号                                                  | 以只读方式打开文件                       |
| **more 文件名**                   | **/**                                                        | **以全屏幕的方式按页显示文本文件的内容** |
| **less 文件名**                   | **/**                                                        | **用来分屏查看文件内容**                 |
| >  文件名                         | ls -l >a.txt 会将列表内容写入文件中                          | 输出重定向（覆盖写）                     |
| >>  文件名                        | ls -l >>a.txt 会将列表内容写入文件中                         | 输出重定向（追加到文件尾部）             |
| echo [选项] 输出内容              | /                                                            | 输出内容到控制台                         |
| head [选项] 文件名                | -n 5 查看文件前5行内容                                       | 显示文件的开头部分内容，默认10行         |
| tail [选项] 文件名                | -n 5 查看文件后5行内容   <br />**-f 实时追踪该文档的所有更新** | 显示文件的末尾部分内容，默认10行         |
| ln -s 原文件或目录 软链接名       | /                                                            | 给原文件创建一个软链接                   |
| history [num]                     | /                                                            | 显示最近使用的num条历史数据              |

## 搜索查找类

| 操作命令                           | 选项                                                        | 含义                                                         |
| ---------------------------------- | ----------------------------------------------------------- | ------------------------------------------------------------ |
| find [搜索范围（某路径下）] [选项] | -name 文件名                                                | 搜索文件                                                     |
|                                    | -user 用户名                                                |                                                              |
|                                    | -size 文件大小    \|大于/小于/等于   -->    +20M -20M 20M\| |                                                              |
| locate 文件名                      | /                                                           | 搜索文件所在路径，**使用前必须使用updatedb创建locate数据库** |
| grep [选项] 查找内容     源文件    | -n 显示匹配行及行号 -i忽略字母大小写                        | 过滤查找， **\|** 表示将前一个命令的处理结果传递给后面的命令处理 |

## 压缩解压类

| 操作命令            | 选项                                                         | 含义                           |
| ------------------- | ------------------------------------------------------------ | ------------------------------ |
| gzip 文件名         | /                                                            | 压缩文件，压缩为 *.gz 文件     |
| gunzip 文件         | /                                                            | 解压文件                       |
| zip [选项] 文件名   | -r 递归压缩                                                  | 压缩文件，压缩为 *.zip 文件    |
| unzip [选项] 文件名 | -d 指定解压后的文件存放目录                                  | 解压文件                       |
| tar [选项] 文件名   | -c 产生tar打包文件  -v 显示详细信息 -f指定压缩后的文件名 -z 打包同时压缩 -x 解包.tar文件 | 打包文件，打包后为 .tar.gz文件 |

## 组管理与权限管理

| 操作命令                   | 选项                | 含义                   |
| -------------------------- | ------------------- | ---------------------- |
| chown 用户名 文件名        | /                   | 修改文件所有者         |
| chown 用户名:用户组 文件名 | -r 文件目录递归生效 | 修改文件所有者及所在组 |
| chgrp 组名 文件名          | /                   | 修改文件所在组         |
| usermod -g 组名 用户名     | /                   | 改变用户所在组         |

### 权限说明

```linux
ls -l
-rwxrw-r-- 1 root root abc.txt
```

`-rwxrw-r--`部分说明：

- 第0位确定文件类型（d  -  l  c  b）
- 第1-3位确定所有者拥有该文件的权限
- 第4-6位确定所属组拥有该文件的权限
- 第7-9位确定其他用户拥有该文件的权限

rwx权限详解：

- 作用于文件
    - r --  表示可以读取、查看
    - w --表示可以修改，不代表可以删除，删除需要拥有该目录的写权限
    - x -- 表示可以被执行 
- 作用于目录
    - r -- 可以读取
    - w -- 可以修改，目录内创建+删除+重命名目录
    - x -- 可以进入该目录



| 操作命令                                            | 选项                             | 含义         |
| --------------------------------------------------- | -------------------------------- | ------------ |
| chmod u=[rwx], g=[rwx], o=[rwx], a=[rwx] 文件目录名 | u 所有者 g所在组 o其他人 a所有人 | 修改文件权限 |
| chmod u+[rwx], g+[rwx], o+[rwx], a+[rwx] 文件目录名 | 同上                             | 添加文件权限 |
| chmod u-[rwx], g-[rwx], o-[rwx], a-[rwx] 文件目录名 | 同上                             | 减少文件权限 |

## 任务调度

任务调度，指系统在某个时间执行的特定命令或程序。

| 操作命令              | 选项                                                         | 含义         |
| --------------------- | ------------------------------------------------------------ | ------------ |
| crontab               | -e 编辑crontab定时任务   -l查询crontab任务   -r 删除当前用户所有的crontab任务 | 任务调度操作 |
| service crond restart | /                                                            | 重启任务调度 |

```linux
crontab -e
* * * * * ls -l /etc > abc.txt
```

### `* * * * *`的说明

| 参数 | 含义               | 范围                    |
| ---- | ------------------ | ----------------------- |
| 1    | 一小时中的第几分钟 | 0-59                    |
| 2    | 一天中的第几小时   | 0-23                    |
| 3    | 一个月中的第几天   | 1-31                    |
| 4    | 一年中的第几月     | 1-12                    |
| 5    | 一周中的星期几     | 0-7（0 7 都代表星期日） |

### 特殊符号的说明

| 符号 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| *    | 代表任何时间，第一个"*"表示每小时的每一分钟都执行一次。      |
| ,    | 表示不连续的时间，比如"0 8,12,16 * * *"，表示每天的8点0分，12点0分，16点0分都执行一次。 |
| -    | 表示连续的时间范围，比如"0 8-12 * * *"，表示每天的8点0分，9点0分直到12点0分都执行一次。 |
| */n  | 表示每个多久执行一次，比如"*/10 * * * *"表示每10分钟执行一次。 |

## 磁盘分区、挂载

Linux归根到底只有一个独立且唯一的文件系统，每个分区都是用来组成文件系统的一部分。

| 操作命令                 | 选项                                 | 含义                       |
| ------------------------ | ------------------------------------ | -------------------------- |
| lsblk                    | /                                    | 查看当前系统的分区情况     |
| fdisk 设备名称           | /                                    | 分区命令                   |
| mkfs -t ext4 设备名称    | /                                    | 格式化，ext4是分区类型     |
| mount 设备名称 挂载目录  | /                                    | 挂载                       |
| umount 设备名称 挂载目录 | /                                    | 卸载                       |
| df [选项]                | -h                                   | 查看系统整体磁盘使用情况   |
| du [选项]                | -s 指定目录占用大小汇总 -h带计量单位 | 查询指定目录的磁盘占用情况 |

### 增加一块硬盘的步骤

虚拟机添加硬盘，分区，格式化，挂载，设置永久挂载

Ps..永久挂载：通过修改/etc/fstab实现挂载，添加完成后，执行mount -a即刻生效

## 进程管理

| 操作命令           | 选项                                                         | 含义       |
| ------------------ | ------------------------------------------------------------ | ---------- |
| ps [选项]          | -a/-e 显示所有进程 -u用户格式显示信息 -x显示后台进程参数 -f 全格式 | 查看进程   |
| kill [选项] 进程号 | -9 强制停止进程                                              | 杀死进程   |
| killall 进程名称   | /                                                            | 杀死进程   |
| pstree [选项]      | -p 显示进程的PID -u显示进程的所属用户                        | 查看进程树 |

| 操作命令                          | 选项 | 含义                               |
| --------------------------------- | ---- | ---------------------------------- |
| chkconfig 服务名 --list           | /    | 查看服务                           |
| chkconfig --level 5 服务名 on/off | /    | 设置对应服务在对应级别下是否自启动 |

Ps.. `chkconfig`设置服务是否自启动后，需要系统重启后生效

| 操作命令   | 选项                                                         | 含义     |
| ---------- | ------------------------------------------------------------ | -------- |
| top [选项] | -d 秒数，每隔几秒更新 -i 不显示闲置或僵死进程 -p 指定监控某个PID的进程状态 | 查看进程 |

Ps.. `top`与Ps的不同之处在于可以更新正在运行的进程。

| 操作命令       | 选项                                         | 含义             |
| -------------- | -------------------------------------------- | ---------------- |
| netstat [选项] | -an 按一定顺序排列输出 -p 显示哪个进程在调用 | 查看系统网络情况 |

